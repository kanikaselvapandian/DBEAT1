<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Wallet</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="/DBEAT1/lendinsync/assets/img/favicon.jpg" rel="icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/DBEAT1/lendinsync/assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="/DBEAT1/lendinsync/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Vue 3 -->
  <script src='https://cdn.jsdelivr.net/npm/vue@3.0.2/dist/vue.global.js'></script>

  <!-- Template Main CSS File -->
  <link href="/DBEAT1/lendinsync/assets/css/style.css" rel="stylesheet">

  <style>
    .card {
        background-color: #c0d0fa;
    }
    .card-deck-scroll {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        scrollbar-width: thin; /* Optional: Adjust scrollbar width */
        width: 100%; /* Ensures full width within the container */
    }
    .card {
        flex: 0 0 250px; /* Fixed width for each card */
        margin-right: 10px; /* Optional: Adjust the margin between cards */
    }
</style>

  <!-- =======================================================
  * Template Name: OnePage
  * Updated: Sep 18 2023 with Bootstrap v5.3.2
  * Template URL: https://bootstrapmade.com/onepage-multipurpose-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">
      <div>
        <img src="/DBEAT1/lendinsync/assets/img/favicon.jpg" width="50" height="50" style="display: inline-block;"><h1 class="logo" style="display: inline-block;"><a href="/home">LendInSync</a></h1>
      </div>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="/home">Home</a></li>
          <li><a class="nav-link scrollto" href="/wallet">Wallets</a></li>
          <li><a class="nav-link scrollto o" href="#services">Loans</a></li>
          <li><a class="nav-link scrollto" href="/profile">Profile</a></li>
          <li><a class="nav-link scrollto"href="/" onclick="logout()">Logout</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->
    </div>
  </header><!-- End Header -->

  <!-- ======= Hero Section ======= -->
  <section id="hero" class="d-flex align-items-center">
    <div class="container position-relative" data-aos="fade-up" data-aos-delay="100">
      <div class="row justify-content-center">
        <div class="col-xl-7 col-lg-9 text-center">
          <h1>Wallet</h1>
        </div>
      </div>

      <div class="row icon-boxes">
        <div class="col-md-12 col-lg-6 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="200">
          <div class="icon-box" style="width: 100%;">
            <div class="icon"><i class="bi bi-wallet-fill"></i></div>
            <h4 class="title">Your Deposit Account Details</h4>
            <p class="description"><h6 id="account_id"></h6> </p>
          </div>
        </div>

        <div class="col-md-12 col-lg-6 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="300">
          <div class="icon-box" style="width: 100%;">
            <div class="icon"><i class="bi bi-send-check-fill"></i></div>
            <h4 class="title">Deposit Account Balance</h4>
            <p class="description"><h6 id="balance"></h6> </p>
          </div>
        </div>
      </div>
    </div>
  </section><!-- End Hero -->


  <main id="wallet">

    <!-- ======= Testimonials Section ======= -->
    <section id="testimonials" class="testimonials">
      <div class="container" data-aos="fade-up">
        <div class="section-title">
          <h2>Your Digital Wallets</h2>
        </div>
        <div class="col-md-12">
          <div class="card-deck-scroll">
              <div class="card" v-for="wallet in customer_wallets">
                  <div class="card-body">
                      <h5 class="card-title" v-text="wallet.CurrencyCode"></h5>
                      <p class="card-text">
                          Amount: <span v-text="wallet.Amount"></span> <br>
                      </p>
                  </div>
              </div>
          </div>
      </div>
      </div>
    </section><!-- End Testimonials Section -->    

    <!-- ======= Services Section ======= -->
    <section id="services" class="services section-bg">
      <div class="container" data-aos="fade-up">

        <div class="section-title">
          <h2>Services</h2>
          <p>Manage your wallet or transact money today!</p>
        </div>

        <div class="row">
            <div class="col-lg-4 col-md-6 d-flex align-items-stretch" data-aos="zoom-in" data-aos-delay="100" data-bs-toggle="modal" data-bs-target="#createWalletModal">
                <div class="icon-box iconbox-blue">
                  <div class="icon">
                    <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                      <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,521.0016835830174C376.1290562159157,517.8887921683347,466.0731472004068,529.7835943286574,510.70327084640275,468.03025145048787C554.3714126377745,407.6079735673963,508.03601936045806,328.9844924480964,491.2728898941984,256.3432110539036C474.5976632858925,184.082847569629,479.9380746630129,96.60480741107993,416.23090153303,58.64404602377083C348.86323505073057,18.502131276798302,261.93793281208167,40.57373210992963,193.5410806939664,78.93577620505333C130.42746243093433,114.334589627462,98.30271207620316,179.96522072025542,76.75703585869454,249.04625023123273C51.97151888228291,328.5150500222984,13.704378332031375,421.85034740162234,66.52175969318436,486.19268352777647C119.04800174914682,550.1803526380478,217.28368757567262,524.383925680826,300,521.0016835830174"></path>
                    </svg>
                    <i class="bi bi-wallet"></i>
                  </div>
                  <h4>Create A Digital Wallet</h4>
                  <p>Create a digital wallet with the currency of your choice</p>
                </div>
            </div>
            
          <div class="col-lg-4 col-md-6 d-flex align-items-stretch mt-4 mt-md-0" data-aos="zoom-in" data-aos-delay="200" data-bs-toggle="modal" data-bs-target="#walletTransaction">
            <div class="icon-box iconbox-orange ">
              <div class="icon">
                <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                  <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,582.0697525312426C382.5290701553225,586.8405444964366,449.9789794690241,525.3245884688669,502.5850820975895,461.55621195738473C556.606425686781,396.0723002908107,615.8543463187945,314.28637112970534,586.6730223649479,234.56875336149918C558.9533121215079,158.8439757836574,454.9685369536778,164.00468322053177,381.49747125262974,130.76875717737553C312.15926192815925,99.40240125094834,248.97055460311594,18.661163978235184,179.8680185752513,50.54337015887873C110.5421016452524,82.52863877960104,119.82277516462835,180.83849132639028,109.12597500060166,256.43424936330496C100.08760227029461,320.3096726198365,92.17705696193138,384.0621239912766,124.79988738764834,439.7174275375508C164.83382741302287,508.01625554203684,220.96474134820875,577.5009287672846,300,582.0697525312426"></path>
                </svg>
                <i class="bi bi-currency-exchange"></i>
              </div>
              <h4><a href="">Transfer between your wallets</a></h4>
              <p>Transact between any of your digital wallets based on current exchange rates</p>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 d-flex align-items-stretch mt-4 mt-lg-0" data-aos="zoom-in" data-aos-delay="300" data-bs-toggle="modal" data-bs-target="#depositTransaction">
            <div class="icon-box iconbox-pink">
              <div class="icon">
                <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                  <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,541.5067337569781C382.14930387511276,545.0595476570109,479.8736841581634,548.3450877840088,526.4010558755058,480.5488172755941C571.5218469581645,414.80211281144784,517.5187510058486,332.0715597781072,496.52539010469104,255.14436215662573C477.37192572678356,184.95920475031193,473.57363656557914,105.61284051026155,413.0603344069578,65.22779650032875C343.27470386102294,18.654635553484475,251.2091493199835,5.337323636656869,175.0934190732945,40.62881213300186C97.87086631185822,76.43348514350839,51.98124368387456,156.15599469081315,36.44837278890362,239.84606092416172C21.716077023791087,319.22268207091537,43.775223500013084,401.1760424656574,96.891909868211,461.97329694683043C147.22146801428983,519.5804099606455,223.5754009179313,538.201503339737,300,541.5067337569781"></path>
                </svg>
                <i class="bi bi-person-vcard-fill"></i>
              </div>
              <h4><a href="">Transfer to Deposit Account</a></h4>
              <p>Transfer money back to your deposit account if needed</p>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 d-flex align-items-stretch mt-4" data-aos="zoom-in" data-aos-delay="100" data-bs-toggle="modal" data-bs-target="#withdrawTransaction">
            <div class="icon-box iconbox-yellow">
              <div class="icon">
                <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                  <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,503.46388370962813C374.79870501325706,506.71871716319447,464.8034551963731,527.1746412648533,510.4981551193396,467.86667711651364C555.9287308511215,408.9015244558933,512.6030010748507,327.5744911775523,490.211057578863,256.5855673507754C471.097692560561,195.9906835881958,447.69079081568157,138.11976852964426,395.19560036434837,102.3242989838813C329.3053358748298,57.3949838291264,248.02791733380457,8.279543830951368,175.87071277845988,42.242879143198664C103.41431057327972,76.34704239035025,93.79494320519305,170.9812938413882,81.28167332365135,250.07896920659033C70.17666984294237,320.27484674793965,64.84698225790005,396.69656628748305,111.28512138212992,450.4950937839243C156.20124167950087,502.5303643271138,231.32542653798444,500.4755392045468,300,503.46388370962813"></path>
                </svg>
                <i class="bi bi-cash-coin"></i>
              </div>
              <h4><a href="">Transact from Deposit Accounts</a></h4>
              <p>Top up your digital wallet from your deposit account based on current exchange rates</p>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 d-flex align-items-stretch mt-4" data-aos="zoom-in" data-aos-delay="200">
            <div class="icon-box iconbox-red">
              <div class="icon">
                <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                  <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,532.3542879108572C369.38199826031484,532.3153073249985,429.10787420159085,491.63046689027357,474.5244479745417,439.17860296908856C522.8885846962883,383.3225815378663,569.1668002868075,314.3205725914397,550.7432151929288,242.7694973846089C532.6665558377875,172.5657663291529,456.2379748765914,142.6223662098291,390.3689995646985,112.34683881706744C326.66090330228417,83.06452184765237,258.84405631176094,53.51806209861945,193.32584062364296,78.48882559362697C121.61183558270385,105.82097193414197,62.805066853699245,167.19869350419734,48.57481801355237,242.6138429142374C34.843463184063346,315.3850353017275,76.69343916112496,383.4422959591041,125.22947124332185,439.3748458443577C170.7312796277747,491.8107796887764,230.57421082200815,532.3932930995766,300,532.3542879108572"></path>
                </svg>
                <i class="bi bi-person-add"></i>
              </div>
              <h4><a href="">Add a Friend!</a></h4>
              <p>Add a friend with their unique user ID to facilitate transactions between your digital wallets</p>
            </div>
          </div>

          <div class="col-lg-4 col-md-6 d-flex align-items-stretch mt-4" data-aos="zoom-in" data-aos-delay="300" data-bs-toggle="modal" data-bs-target="#peerWalletTransaction">
            <div class="icon-box iconbox-teal">
              <div class="icon">
                <svg width="100" height="100" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg">
                  <path stroke="none" stroke-width="0" fill="#f5f5f5" d="M300,566.797414625762C385.7384707136149,576.1784315230908,478.7894351017131,552.8928747891023,531.9192734346935,484.94944893311C584.6109503024035,417.5663521118492,582.489472248146,322.67544863468447,553.9536738515405,242.03673114598146C529.1557734026468,171.96086150256528,465.24506316201064,127.66468636344209,395.9583748389544,100.7403814666027C334.2173773831606,76.7482773500951,269.4350130405921,84.62216499799875,207.1952322260088,107.2889140133804C132.92018162631612,134.33871894543012,41.79353780512637,160.00259165414826,22.644507872594943,236.69541883565114C3.319112789854554,314.0945973066697,72.72355303640163,379.243833228382,124.04198916343866,440.3218312028393C172.9286146004772,498.5055451809895,224.45579914871206,558.5317968840102,300,566.797414625762"></path>
                </svg>
                <i class="bi bi-people"></i>
              </div>
              <h4><a href="http://127.0.0.1:5000/profile">Transact to your friend's wallet</a></h4>
              <p>Transfer money to your friend's digital wallet of your choice</p>
            </div>
          </div>

        </div>

      </div>
    </section><!-- End Services Section -->


    <!-- ======= Transactions Section ======= -->
    <section id = "transactions">
        <div class="container" data-aos="fade-up">
            <div class="section-title">
                <h2>Your Past Transactions</h2>
            </div>
            <table class="table table-light table-striped">
                <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Source Wallet</th>
                        <th>Destination Wallet</th>
                        <th>Amount</th>
                        <th>Exchange Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="transaction in customer_transactions">
                        <td v-text="transaction.TimeStamp"></td>
                        <td v-text="transaction.SourceWallet"></td>
                        <td v-text="transaction.DestinationWallet"></td>
                        <td v-text="transaction.AmountTransferred"></td>
                        <td v-text="transaction.ExchangeRate"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>


    <!-- ======= End Transactions Section ======= -->

    <div class="modal fade" id="walletTransaction" aria-hidden="true" aria-labelledby="walletTransactionLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="walletTransactionLavel">Transact between Wallets</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style = "padding: 20px">
                <div class = "container">
                    <form>
                        <div class="form-group">
                            <label for="customerid">Customer ID:</label>
                            <input type="text" class="form-control" :value = customer_id disabled> 
                        </div>
                        <div class="form-group">
                            <label for="wallet">Source Wallet:</label>
                            <select class="form-control" @change="updateSourceAndCheck" v-model="sourcewallet">
                                <option v-for="wallet in availableSourceWallets" :value="wallet" v-text ="wallet.WID + '. ' + wallet.CurrencyCode + ' ' + wallet.Amount">
                                </option>
                            </select>                            
                        </div>
                    
                        <div class="form-group">
                            <label for="wallet">Destination Wallet:</label>
                            <select class="form-control" @change="updateSourceAndCheck" v-model="destinationwallet">
                                <option v-for="wallet in availableDestinationWallets" :value="wallet" v-text ="wallet.WID + '. ' + wallet.CurrencyCode + ' ' + wallet.Amount">
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount transferred from source wallet:</label>
                            <input type="number" class="form-control" :value="wallet_amount" @input="updateAmount" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label for="exchange_rate">Exchange Rate:</label>
                            <input type="text" class="form-control" :value = exchange_rate disabled>
                        </div>
                        <button type="submit" class="btn btn-block my-3" style="background-color: #c0d0fa; color: black; width: 100%" @click="createTransaction(WalletTransaction=true, PeerTransaction = false, $event)">Submit</button>
                    </form>
                    <div v-if = "errorsFound">
                        <hr>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                                <li v-for="error in validation_errors" v-text = "error"></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
            </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="depositTransaction" aria-hidden="true" aria-labelledby="depositTransactionLabel" tabindex="-1" data-bs-backdrop="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="walletTransactionLavel">Deposit Money</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style = "padding: 20px">
                <div class = "container">
                    <form>
                        <div class="form-group">
                            <label for="customerid">Deposit Account:</label>
                            <input type="text" class="form-control" :value = "deposit_account" disabled> 
                        </div>
                        <div class="form-group">
                            <label for="currency">Source Wallet:</label>
                            <select class="form-control" v-model="sourcewallet" @change = "getExchangeRate(sourcewallet.CurrencyCode)">
                                <option v-for="wallet in customer_wallets" :value="wallet" v-text ="wallet.WID + '. ' + wallet.CurrencyCode + ' ' + wallet.Amount">
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount transferred from wallet:</label>
                            <input type="text" class="form-control" v-model="wallet_amount">
                        </div>
                        <div class="form-group">
                            <label for="exchange_rate">Exchange Rate:</label>
                            <input type="text" class="form-control" :value = exchange_rate disabled>
                        </div>
                        <button type="submit" class="btn btn-block my-3" style="background-color: #c0d0fa; color: black; width: 100%" @click="createTransaction(WalletTransaction=false, PeerTransaction = false, $event)">Submit</button>
                    </form>
                    <div v-if = "errorsFound">
                        <hr>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                                <li v-for="error in validation_errors" v-text = "error"></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
        </div>
        </div>
    </div>
    </div>
    <div class="modal fade" id="withdrawTransaction" aria-hidden="true" aria-labelledby="withdrawTransactionLabel" tabindex="-1" data-bs-backdrop="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="walletTransactionLavel">Deposit Money</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style = "padding: 20px">
                <div class = "container ">
                    <form>
                        <div class="form-group">
                            <label for="customerid">Source Account:</label>
                            <input type="text" class="form-control" :value = "deposit_account" disabled> 
                        </div>
                        <div class="form-group">
                            <label for="currency">Destination Wallet:</label>
                            <select class="form-control" v-model="destinationwallet" @change = "getExchangeRate(destinationwallet.CurrencyCode)">
                                <option v-for="wallet in customer_wallets" :value="wallet" v-text ="wallet.WID + '. ' + wallet.CurrencyCode + ' ' + wallet.Amount">
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount transferred to wallet:</label>
                            <input type="text" class="form-control" v-model="wallet_amount">
                        </div>
                        <div class="form-group">
                            <label for="exchange_rate">Exchange Rate:</label>
                            <input type="text" class="form-control" :value = exchange_rate disabled>
                        </div>
                        <button type="submit" class="btn btn-block my-3" style="background-color: #c0d0fa; color: black; width: 100%" @click="createTransaction(WalletTransaction=false, PeerTransaction = false, $event)">Submit</button>
                    </form>
                    <div v-if = "errorsFound">
                        <hr>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                                <li v-for="error in validation_errors" v-text = "error"></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
        </div>
        </div>
    </div>
    </div>
    <div class="modal fade" id="createWalletModal" aria-hidden="true" aria-labelledby="createWalletModalLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="createWalletModalLabel">Create Wallet</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body d-flex flex-column align-items-center" style = "padding:20px">
                <form>
                    <div class="form-group">
                        <label for="customerid">Customer ID:</label>
                        <input type="text" class="form-control" :value = customer_id disabled> 
                    </div>
                    <div class="form-group">
                        <label for="currency">Currency:</label>
                        <select v-model="selectedCurrency" class = "form-control" @change="getExchangeRate(selectedCurrency)">
                            <option v-for="currency in currency_info" :value="currency.CurrencyCode" v-text ="currency.CountryName + ' (' + currency.CurrencyCode + ')'">
                            </option>
                        </select>
                    </div>
                    <div class="form-group"> 
                        <label for="amount" class="form-label">Amount:</label>
                        <input type="number" class="form-control" id="amount" v-model="wallet_amount" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="exchange_rate">Exchange Rate:</label>
                        <input type="text" class="form-control" :value = exchange_rate disabled>
                    </div>
                    <button type="submit" class="btn btn-block my-3" style="background-color: #c0d0fa; color: black; width: 100%" @click="createWallet($event)">Submit</button>
                </form>
                <div v-if = "errorsFound">
                    <hr>
                    <div class="alert alert-danger" role="alert">
                        <ul>
                            <li v-for="error in validation_errors" v-text = "error"></li>
                        </ul>
                    </div>
                </div>
            </div>                    
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
            </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="peerWalletTransaction" aria-hidden="true" aria-labelledby="peerWalletTransactionLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="peerWalletTransactionLabel">Peer to Peer Wallet Transaction</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style = "padding: 20px">
                <div class = "container ">
                    <form>
                        <div class="form-group">
                            <label for="wallet">Your Wallet:</label>
                            <select class="form-control" v-model="sourcewallet" @change = "checkWalletsSelection">
                                <option v-for="wallet in availableSourceWallets" :value="wallet" v-text ="wallet.WID + '. ' + wallet.CurrencyCode + ' (' + wallet.Amount + ')' ">
                                </option>
                            </select>                            
                        </div>
                        <div class="form-group">
                            <label for="wallet">Friend:</label>
                            <select class="form-control" v-model="destinationfriend" @change="getFriendsWallets">
                                <option v-for="friend in friends_info" :value="friend" v-text ="friend.friendee_name">
                                </option>
                            </select>
                        </div>
                        <div v-if="destinationfriend !== null && friend_wallets_received" class="form-group" @change = "checkWalletsSelection">
                            <label for="wallet">Friend's Wallet:</label>
                            <select class="form-control" v-model="destination_friend_wallet">
                                <option v-for="wallet in friend_wallets" :value="wallet" v-text="wallet.WID + '. ' + wallet.CurrencyCode"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount transferred from your wallet:</label>
                            <input type="number" class="form-control" :value="wallet_amount" @input="updateAmount" step="0.1" min="0.1">
                        </div>
                        <div class="form-group">
                            <label for="exchange_rate">Exchange Rate:</label>
                            <input type="text" class="form-control" :value = exchange_rate disabled>
                        </div>
                        <button type="submit" class="btn btn-block my-3" style="background-color: #c0d0fa; color: black; width: 100%" @click="createTransaction(WalletTransaction=false, PeerTransaction = true, $event)">Submit</button>
                    </form>
                    <div v-if = "errorsFound">
                        <hr>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                                <li v-for="error in validation_errors" v-text = "error"></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
            </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="successModal" aria-hidden="true" aria-labelledby="successModalLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="successModalLabel">Success!</h1>
            </div>
            <div class="modal-body d-flex flex-column align-items-center">
                <h5>Successfully Created Wallet!</h5>
            </div>                    
            </div>
        </div>
    </div>
    <div class="modal fade" id="unsuccessfulModal" aria-hidden="true" aria-labelledby="unsuccessfulModalLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="unsuccessfulModalLabel">Not Successful</h1>
            </div>
            <div class="modal-body d-flex flex-column align-items-center">
                <h5>Unfortunately, we are unable to create your wallet now, please try again later</h5>
            </div>                    
            </div>
        </div>
    </div>
    <div class="modal fade" id="successModalTransaction" aria-hidden="true" aria-labelledby="successModalTransactionLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="successModalTransactionLabel">Success!</h1>
            </div>
            <div class="modal-body d-flex flex-column align-items-center">
                <h5>Successfully Created Transaction!</h5>
            </div>                    
            </div>
        </div>
    </div>
    <div class="modal fade" id="unsuccessfulModalTransaction" aria-hidden="true" aria-labelledby="unsuccessfulModalTransactionLabel" tabindex="-1" data-bs-backdrop="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="unsuccessfulModalTransactionLabel">Not Successful</h1>
            </div>
            <div class="modal-body d-flex flex-column align-items-center">
                <h5>Unfortunately, we are unable to facilitate your transaction at the moment, please try again later</h5>
            </div>                    
            </div>
        </div>
    </div>

  </main><!-- End #main -->
  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container d-md-flex py-4">
      <div class="me-md-auto text-center text-md-start">
        <div class="copyright">
          &copy; Copyright <strong><span>LendInSync</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
          <!-- All the links in the footer should remain intact. -->
          <!-- You can delete the links only if you purchased the pro version. -->
          <!-- Licensing information: https://bootstrapmade.com/license/ -->
          <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/onepage-multipurpose-bootstrap-template/ -->
          Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
        </div>
      </div>
    </div>
  </footer><!-- End Footer -->

  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
    await checkLocalStorageAndRedirect();
});

async function checkLocalStorageAndRedirect() {
    const username = localStorage.getItem('username');
    if (!username) {
        window.location.href = '/';
    }
    // ... any other async operations
}

</script>
  <!-- Vendor JS Files -->
  <script src="/DBEAT1/lendinsync/assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/aos/aos.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="/DBEAT1/lendinsync/assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="/DBEAT1/lendinsync/assets/js/main.js"></script>
    <script>
    const customer_id = "A123456";
    const get_wallets_by_customerid = "http://127.0.0.1:7000/wallet/" + customer_id;
    const get_wallets = "http://127.0.0.1:7000/wallet/"
    const get_transactions_by_customerid = "http://127.0.0.1:8000/transaction/" + customer_id;
    const create_wallet = "http://127.0.0.1:7000/wallet";
    const create_transaction = "http://127.0.0.1:6100/transfer";
    const get_friends_by_customerid = "http://localhost:8895/friends/" + customer_id;
    const create_peer_transaction = "http://127.0.0.1:6100/peer_transfer";
    const deposit_account = "0000010505"
    const deposit_account_balance = "40000"

    const wallet = Vue.createApp({
    data() {
        return {
        customer_wallets: [],
        customer_transactions: [],
        wallets_received: false,
        transactions_received: false,
        message: '', // Define a message property for error handling
        data_received: false,
        currency_info: [],
        selectedCurrency: "",
        customer_id: customer_id,
        deposit_account: deposit_account,
        wallet_amount: 0,
        exchange_rate: 0,
        sourcewallet: null,
        destinationwallet: null,
        availableDestinationWallets: [],
        availableSourceWallets: [],
        deposit_account_balance: deposit_account_balance,
        validation_errors: [],
        errorsFound: false,
        friends_info: [],
        friends_received: false,
        destinationfriend: null,
        friend_wallets: [],
        friend_wallets_received: false,
        destination_friend_wallet: null
        };
    },
    methods: {
        openModal() {
            this.errorsFound = false;
            this.sourcewallet = null;
            this.destinationwallet = null;
            this.wallet_amount = 0; 
            this.selectedCurrency = "";
            this.validation_errors = [];
        },
        async get_wallets() {
        try {
            const response = await fetch(get_wallets_by_customerid);
            const data = await response.json();

            if (data.code === 404) {
            this.message = data.message;
            } else {
            this.customer_wallets = data.data.wallet; 
            this.wallets_received = true;
            this.availableSourceWallets = this.customer_wallets;
            this.availableDestinationWallets = this.customer_wallets;
            this.checkDataReceived();
            }
        } catch (error) {
            console.error('Error fetching wallets:', error);
            this.message = 'Error fetching wallet data: ' + error;
        }
        },
        async get_transactions() {
        try {
            const response = await fetch(get_transactions_by_customerid);
            const data = await response.json();

            if (data.code === 404) {
            this.message = data.message;
            } else {
            this.customer_transactions = data.data.transactions;
            this.transactions_received = true;
            this.checkDataReceived();
            }
        } catch (error) {
            this.message = 'Error fetching transaction data: ' + error;
        }
        },
        async get_friends() {
        try {
            const response = await fetch(get_friends_by_customerid);
            const data = await response.json();

            if (data.code === 404) {
            this.message = data.message;
            } else {
            this.friends_info = data.data.friends;
            this.friends_received = true;
            this.checkDataReceived();
            }
        } catch (error) {
            this.message = 'Error fetching transaction data: ' + error;
        }
        },
        checkDataReceived() {
        if (this.wallets_received && this.transactions_received && friends_received) {
            this.data_received = true;
        }
        },
        async getCurrencyCodes(){
            const response = await fetch('http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "getCurrencyList", "userID": "", "PIN": "", "OTP": ""}&Content={"baseCurrency": "", "quoteCurrency": ""}');
            const data = await response.json();
            this.currency_info = data.Content.ServiceResponse.CurrencyList.Currency;
        },
        async getExchangeRate(currency_code){
            const response = await fetch(`http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "getExchangeRate", "userID": "", "PIN": "", "OTP": ""}&Content={"baseCurrency": "SGD", "quoteCurrency": "${currency_code}"}`);
            const data = await response.json();
            this.exchange_rate = data.Content.ServiceResponse["FX_SpotRate_Read-Response"]["Rate"];
        },
        updateSourceAndCheck() {
        this.updateSourceWallets();
        this.checkWalletsSelection();
        },
        checkWalletsSelection() {
            console.log("checking")
            if (this.sourcewallet && this.destinationwallet) {
                console.log("checking!")
                this.getWalletExchange();
            }
            else if (this.sourcewallet && this.destination_friend_wallet){
                this.getWalletExchange();
            }
        },
        async getWalletExchange() {
            console.log("here");
            console.log(this.sourcewallet);
            console.log(this.destinationwallet);
            if (this.sourcewallet && this.destinationwallet) {
                console.log("Both wallets have been selected")
                const response = await fetch(`http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "getExchangeRate", "userID": "", "PIN": "", "OTP": ""}&Content={"baseCurrency": "${this.sourcewallet.CurrencyCode}", "quoteCurrency": "${this.destinationwallet.CurrencyCode}"}`);
                const data = await response.json();
                console.log(data)
                this.exchange_rate = data.Content.ServiceResponse["FX_SpotRate_Read-Response"]["Rate"];
                console.log(this.exchange_rate);
            } 
            else if (this.sourcewallet && this.destination_friend_wallet){
                console.log("Both wallets have been selected");
                const response = await fetch(`http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "getExchangeRate", "userID": "", "PIN": "", "OTP": ""}&Content={"baseCurrency": "${this.sourcewallet.CurrencyCode}", "quoteCurrency": "${this.destination_friend_wallet.CurrencyCode}"}`);
                const data = await response.json();
                this.exchange_rate = data.Content.ServiceResponse["FX_SpotRate_Read-Response"]["Rate"];
            }
            else {
                console.log("Both source and destination wallets need to be chosen.");
            }
        },    
        async createWallet(event) {
            event.preventDefault();
            this.validation_errors = []
            if (this.wallet_amount > this.deposit_account_balance) {
                this.validation_errors.push("Insufficient funds in deposit account");
            }
            if (this.wallet_amount <= 0) {
                this.validation_errors.push("Amount must be greater than 0");
            }
            if (this.selectedCurrency == "") {
                this.validation_errors.push("Please select a currency");
            }
            if (this.validation_errors.length > 0) {
                this.errorsFound = true
                return;
            }
            else {
                this.validation_errors = [];
                this.errorsFound = false;
                const jsonData = JSON.stringify({
                CustomerId: this.customer_id,
                CurrencyCode: this.selectedCurrency,
                Amount: this.wallet_amount * this.exchange_rate
            });
        
            const url = create_wallet;
            const postMethod = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: jsonData
            };
        
            try {
                const response = await fetch(url, postMethod);
                const data = await response.json();
        
                switch (data.code) {
                    case 201:
                        // Handle success case
                        console.log("Successfully created wallet");
                        // Close the createWalletModal
                        $('#createWalletModal').modal('hide');
                        // Show success modal
                        $('#successModal').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000); // Example: Reload after 1 second (1000 milliseconds)
                        break;
                    case 500:
                        this.message = data.message;
                        // Close the createWalletModal
                        $('#createWalletModal').modal('hide');
                        // Show unsuccessful modal
                        $('#unsuccessfulModal').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000); // Example: Reload after 1 seconds (1000 milliseconds)
                        break;
                    default:
                        throw `${data.code}: ${data.message}`;
                }
            } catch (error) {
                console.error('Error');
            }
            }
        },
        async createTransaction(WalletTransaction, PeerTransaction, event) {
            event.preventDefault();
            this.validation_errors = []
            this.errorsFound = false;
            if (WalletTransaction && PeerTransaction == false){
                if (this.sourcewallet == null) {  
                this.validation_errors.push("Please select a source wallet");
                }
                if (this.destinationwallet == null) {
                this.validation_errors.push("Please select a destination wallet");
                }
                if (this.sourcewallet != null && this.wallet_amount > this.sourcewallet.Amount) {
                this.validation_errors.push("Insufficient funds in source wallet");
                }
                if (this.wallet_amount <= 0 || this.wallet_amount == "") {
                this.validation_errors.push("Amount must be greater than 0");
                }
                if (this.validation_errors.length > 0) {
                this.errorsFound = true
                return;
                }
                else {
                    this.walletWalletTransaction()
                }
            }
            else if (WalletTransaction == false && this.sourcewallet == null && PeerTransaction == false) {
                console.log("hereeeeee")
                if (parseFloat(this.wallet_amount) > parseFloat(this.deposit_account_balance)) {
                    console.log(parseFloat(this.wallet_amount) - parseFloat(this.deposit_account_balance))
                    this.validation_errors.push("Insufficient funds in deposit account");
                }
                if (this.wallet_amount <= 0 || this.wallet_amount == "") {
                    this.validation_errors.push("Amount must be greater than 0");
                }
                if (this.destinationwallet == null) {
                    this.validation_errors.push("Please select a destination wallet");
                }
                if (this.validation_errors.length > 0) {
                    this.errorsFound = true
                return;
                }
                else {
                    // Perform wallet transaction
                        try {
                            const response = await this.withdrawWalletAndCallAPI();
                            // Check response and handle success/failure
                            if (response.walletTransaction.code === 201 && response.apiResponse === 'invocation successful') {
                                // Both transactions succeeded
                                // Close the createWalletModal
                                $('#walletTransaction').modal('hide');
                                // Show success modal
                                $('#successModalTransaction').modal('show');
                                // Reload page after a delay (you can change the delay as needed)
                                // setTimeout(() => {
                                //     window.location.reload();
                                // }, 1000); // Example: Reload after 1 second (1000 milliseconds)
                            } else {
                                // Close the createWalletModal
                                $('#walletTransaction').modal('hide');
                                // Show unsuccessful modal
                                $('#unsuccessfulModalTransaction').modal('show');
                                // Reload page after a delay (you can change the delay as needed)
                                // setTimeout(() => {
                                //     window.location.reload();
                                // }, 2000); // Example: Reload after 1 seconds (1000 milliseconds)
                            }
                        } catch (error) {
                            console.error('Error:', error);
                            // Handle error
                        }
                }
            }
            else if (PeerTransaction == true){
                if (this.sourcewallet == null) {  
                this.validation_errors.push("Please select a source wallet");
                }
                if (this.destination_friend_wallet == null) {
                this.validation_errors.push("Please select a destination wallet");
                }
                if (this.sourcewallet != null && this.wallet_amount > this.sourcewallet.Amount) {
                this.validation_errors.push("Insufficient funds in source wallet");
                }
                if (this.wallet_amount <= 0 || this.wallet_amount == "") {
                this.validation_errors.push("Amount must be greater than 0");
                }
                if (this.validation_errors.length > 0) {
                this.errorsFound = true
                return;
                }
                else {
                    this.peerWalletTransaction()
                }
            }
            else {
                console.log("here")
                if (this.sourcewallet != null && parseFloat(this.wallet_amount) > parseFloat(this.sourcewallet.Amount)) {
                    this.validation_errors.push("Insufficient funds in source wallet");
                }
                if (this.wallet_amount <= 0 || this.wallet_amount == "") {
                    this.validation_errors.push("Amount must be greater than 0");
                }
                if (this.sourcewallet == null) {
                    this.validation_errors.push("Please select a source wallet");
                }
                if (this.validation_errors.length > 0) {
                    console.log(this.wallet_amount)
                    console.log(this.sourcewallet.Amount)
                    console.log(this.validation_errors)
                    this.errorsFound = true
                    return;
                }
                else {
                // Perform wallet transaction
                    try {
                            const response = await this.depositWalletAndCallAPI();
                            // Check response and handle success/failure
                            if (response.walletTransaction.code === 201 && response.apiResponse === 'invocation successful') {
                                // Both transactions succeeded
                                // Close the createWalletModal
                                $('#walletTransaction').modal('hide');
                                // Show success modal
                                $('#successModalTransaction').modal('show');
                                // Reload page after a delay (you can change the delay as needed)
                                // setTimeout(() => {
                                //     window.location.reload();
                                // }, 1000); // Example: Reload after 1 second (1000 milliseconds)
                            } else {
                                // Close the createWalletModal
                                $('#walletTransaction').modal('hide');
                                // Show unsuccessful modal
                                $('#unsuccessfulModalTransaction').modal('show');
                                // Reload page after a delay (you can change the delay as needed)
                                // setTimeout(() => {
                                //     window.location.reload();
                                // }, 2000); // Example: Reload after 1 seconds (1000 milliseconds)
                            }
                            } catch (error) {
                                console.error('Error:', error);
                                // Handle error
                        }
                }
            }
        },
        async walletWalletTransaction() {
            const currentDate = new Date();  // Your new Date() object
            // Format the date as a string in the desired MySQL DATETIME format
            const formattedDate = currentDate.toISOString().slice(0, 19).replace('T', ' ');
            const jsonData = JSON.stringify({
                "SourceWallet": this.sourcewallet.WID,
                "DestinationWallet": this.destinationwallet.WID,
                "CustomerId": this.customer_id,
                "WalletTransaction": true,
                "ExchangeRate": this.exchange_rate,
                "TimeStamp": formattedDate,
                "AmountTransferred": this.wallet_amount
                });
                const url = create_transaction;
                const postMethod = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: jsonData
            };
        
            try {
                const response = await fetch(url, postMethod);
                const data = await response.json();
                console.log(data)
                switch (data.code) {
                    case 201:
                        // Handle success case
                        // Close the createWalletModal
                        $('#walletTransaction').modal('hide');
                        // Show success modal
                        $('#successModalTransaction').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000); // Example: Reload after 1 second (1000 milliseconds)
                        break;
                    case 500:
                        this.message = data.message;
                        // Close the createWalletModal
                        $('#walletTransaction').modal('hide');
                        // Show unsuccessful modal
                        $('#unsuccessfulModalTransaction').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000); // Example: Reload after 1 seconds (1000 milliseconds)
                        break;
                    default:
                        throw `${data.code}: ${data.message}`;
                }
            } 
            catch (error) {
                console.error('Error:', error);
                // Handle other errors or display a general error message
            }
        },
        async depositWalletTransaction() {
            const currentDate = new Date();  // Your new Date() object
            // Format the date as a string in the desired MySQL DATETIME format
            const formattedDate = currentDate.toISOString().slice(0, 19).replace('T', ' ');
            const jsonData = JSON.stringify({
            "SourceWallet": this.sourcewallet.WID,
            "DestinationWallet": "",
            "CustomerId": this.customer_id,
            "WalletTransaction": false,
            "ExchangeRate": this.exchange_rate,
            "TimeStamp": formattedDate,
            "AmountTransferred": this.wallet_amount
            });

            const url = create_transaction;
            const postMethod = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: jsonData
            };
        
            try {
                const response = await fetch(url, postMethod);
                const data = await response.json();
                console.log(data)
                return data
            } 
            catch (error) {
                console.error('Error:', error);
                // Handle other errors or display a general error message
            }
        },
        async withdrawWalletTransaction() {
            const currentDate = new Date();  
            // Format the date as a string in the desired MySQL DATETIME format
            const formattedDate = currentDate.toISOString().slice(0, 19).replace('T', ' ');
            const jsonData = JSON.stringify({
            "SourceWallet": "",
            "DestinationWallet": this.destinationwallet.WID,
            "CustomerId": this.customer_id,
            "WalletTransaction": false,
            "ExchangeRate": this.exchange_rate,
            "TimeStamp": formattedDate,
            "AmountTransferred": this.wallet_amount
            });
            const url = create_transaction;
            const postMethod = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: jsonData
            };
            try {
                const response = await fetch(url, postMethod);
                const data = await response.json();
                console.log(data)
                return data
            } 
            catch (error) {
                console.error('Error:', error);
                // Handle other errors or display a general error message
            }
        },
        async peerWalletTransaction(){
            const currentDate = new Date();  // Your new Date() object
            // Format the date as a string in the desired MySQL DATETIME format
            const formattedDate = currentDate.toISOString().slice(0, 19).replace('T', ' ');
            const jsonData = JSON.stringify({
                "SourceWallet": this.sourcewallet.WID,
                "DestinationWallet": this.destination_friend_wallet.WID,
                "CustomerId": this.customer_id,
                "ExchangeRate": this.exchange_rate,
                "TimeStamp": formattedDate,
                "AmountTransferred": this.wallet_amount
                });
                const url = create_peer_transaction;
                const postMethod = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: jsonData
            };
            try {
                const response = await fetch(url, postMethod);
                const data = await response.json();
                console.log(data)
                switch (data.code) {
                    case 201:
                        // Handle success case
                        // Close the createWalletModal
                        $('#walletTransaction').modal('hide');
                        // Show success modal
                        $('#successModalTransaction').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000); // Example: Reload after 1 second (1000 milliseconds)
                        break;
                    case 500:
                        this.message = data.message;
                        // Close the createWalletModal
                        $('#walletTransaction').modal('hide');
                        // Show unsuccessful modal
                        $('#unsuccessfulModalTransaction').modal('show');
                        // Reload page after a delay (you can change the delay as needed)
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000); // Example: Reload after 1 seconds (1000 milliseconds)
                        break;
                    default:
                        throw `${data.code}: ${data.message}`;
                }
            } 
            catch (error) {
                console.error('Error:', error);
                // Handle other errors or display a general error message
            }
        },
        updateDestinationWallets() {
        if (this.sourcewallet) {
            this.availableDestinationWallets = this.customer_wallets.filter(wallet => wallet.WID !== this.sourcewallet.WID);
        } else {
            this.availableDestinationWallets = this.customer_wallets;
        }
        },
        updateSourceWallets() {
            if (this.destinationwallet) {
                this.availableSourceWallets = this.customer_wallets.filter(wallet => wallet.WID !== this.destinationwallet.WID);
            } else {
                this.availableSourceWallets = this.customer_wallets;
            }
        },
        updateAmount(event) {
        // Update the wallet_amount when the input changes
        const value = parseFloat(event.target.value);
        this.wallet_amount = isNaN(value) || value < 0 ? 0.1 : value;
        },
        async getFriendsWallets(){
            this.friend_wallets_received = false;
            try {
            const friend_wallet_url = get_wallets + this.destinationfriend.friendee_id;
            const response = await fetch(friend_wallet_url);
            const data = await response.json();

            if (data.code === 404) {
            this.message = data.message;
            } else {
            this.friend_wallets = data.data.wallet; 
            this.friend_wallets_received = true;
            }
        } catch (error) {
            console.error('Error fetching wallets:', error);
            this.message = 'Error fetching wallet data: ' + error;
        }
        },
        async withdrawWalletAndCallAPI() {
            try {
                const walletTransactionResponse = await this.withdrawWalletTransaction();
                let apiResponse;
                if (walletTransactionResponse.code === 201) {
                    apiResponse = await this.callExternalAPI(type = "withdraw");
                }
                return {
                    walletTransaction: walletTransactionResponse,
                    apiResponse: apiResponse
                };
            } catch (error) {
                console.error('Error:', error);
                throw error;
            }
        },
        async depositWalletAndCallAPI() {
            try {
                const walletTransactionResponse = await this.depositWalletTransaction();
                let apiResponse;
                if (walletTransactionResponse.code === 201) {
                    apiResponse = await this.callExternalAPI(type = "deposit");
                }
                return {
                    walletTransaction: walletTransactionResponse,
                    apiResponse: apiResponse
                };
            } catch (error) {
                console.error('Error:', error);
                throw error;
            }
        },
        async callExternalAPI(type) {
            if(type == "withdraw"){
                try {
                const externalAPIResponse = await fetch(`http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "withdrawCash", "userID": "T829103K", "PIN": "1", "OTP": ""}&Content={"accountID": "${this.deposit_account}", "amount": "${this.wallet_amount}", "narrative": "testing"}&ConsumerID=Teller`);

                const data = await externalAPIResponse.json();
                const message = data.Content.ServiceResponse["ServiceRespHeader"]["ErrorText"];
                return message; // Return the data from the external API call
            } catch (error) {
                console.error('Error calling external API:', error);
                throw error;
            }
        }
        else {
            try {
                const externalAPIResponse = await fetch(`http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName": "depositCash", "userID": "T829103K", "PIN": "1", "OTP": ""}&Content={"accountID": "${this.deposit_account}", "amount": "${this.wallet_amount}", "narrative": "testing"}&ConsumerID=Teller`);

                const data = await externalAPIResponse.json();
                const message = data.Content.ServiceResponse["ServiceRespHeader"]["ErrorText"];
                return message; // Return the data from the external API call
            } catch (error) {
                console.error('Error calling external API:', error);
                throw error;
            }
        }
    }
    },
    mounted() {
        this.get_wallets();
        this.get_transactions();
        this.getCurrencyCodes();
        this.get_friends();
    },
    });
    const vm = wallet.mount('#wallet');
    </script>
    <script>
        function logout() {
       localStorage.clear();
       window.location.href = "/";
   }
   
     </script>

<script>
   document.addEventListener('DOMContentLoaded', () => {
    const username = localStorage.getItem('username');
    const pin = localStorage.getItem('pin');
    const customer_url = `http://tbankonline.com/SMUtBank_API/Gateway?Header={"serviceName":"getCustomerAccounts","userID":"${username}","PIN":"${pin}","OTP":"999999"}`;

    fetch(customer_url)
        .then(response => response.json())
        .then(data => {
            console.log(data);
            let accounts = data.Content.ServiceResponse.AccountList.account;
            let accountIdString = '';
            let balanceString = '';

            for (let i = 0; i < accounts.length; i++) {
                // Check if parentAccountFlag is true for the current account
                if (accounts[i].parentAccountFlag=='true') {
                    accountIdString += 'Account ID ' + (i+1) + ': ' + accounts[i].accountID + '<br>';
                    balanceString += 'Balance for Account ' + (i+1) + ': ' + accounts[i].currency + " " + accounts[i].balance + '<br>';
                }
            }

            document.querySelector('#account_id').innerHTML = accountIdString;
            document.querySelector('#balance').innerHTML = balanceString;
        })
        .catch(error => {
            console.error('An error occurred:', error);
        });
});

</script>

</body>

</html>